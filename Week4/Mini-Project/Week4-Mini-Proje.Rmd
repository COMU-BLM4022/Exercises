---
title: "R Notebook"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

T.C. Çevre Şehircilik ve İklim Değişikliği bakanlığının ülke genelinde yaptığı hava kalitesi
ölçümleri [https://sim.csb.gov.tr/Services/AirQuality](https://sim.csb.gov.tr/Services/AirQuality) adresinde bulunan web uygulamasında istasyon bazında görsellenebilmektedir. 

Ham veriler ise [https://sim.csb.gov.tr/STN/STN_Report/StationDataDownloadNew](https://sim.csb.gov.tr/STN/STN_Report/StationDataDownloadNew) adresinden *Excel* formatında indirlebilmektedir. 

## Egzersiz 1 - Veri ithali

**Doğduğunuz şehre** ait olan **saatlik** hava kalitesi parametrelerini *Excel* formatında **doğduğunuz ay** için indirin. Tam bir aylık veri indirmeniz gerekmektedir.

Örnek :

- Mart ayında doğduysanız Mart 2023 verisi (Çünkü Mart 2024 bitmedi)
- Aralık ayında doğduysanız Aralık 2023 verisi
- Şubat ayında doğduysanız Şubat 2024 verisi

```{r}
# Excel dosyasındaki ham verileri data.frame formatında R'a ithal edin
library(readxl)
havaK <- read_excel("IzmirOcakHava.xlsx")
```

## Egzersiz 2 - Veri Kalite Kontrolü

*havaK* adlı değişkendeki bütün verilerin **numric** tipte olmasını sağlayın. Eksik veriler NA olmalıdır.

```{r}
havaK
havaK[, -1][havaK[,-1] == "-"] <- NA
havaK[,-1] <- sapply(havaK[,-1], function(x) {
    x <- gsub("\\.", "", x)
    x <- gsub(",", ".", x)
    as.numeric(x)
})
havaK

```

## Egzersiz 3 - Veri Görselleme

*havaK* adlı değişkendeki bütün verilerin **numric** tipte olmasını sağlayın. Eksik veriler NA olmalıdır.

```{r}
# NA değerleri mean ile doldurup grafik çıkartma
library(dygraphs)

fill_na_with_mean <- function(column) {
    column[is.na(column)] <- mean(column, na.rm = TRUE)
    return(column)
}
havaK_filled_mean <- havaK
havaK_filled_mean[,-1] <- sapply(havaK[,-1], fill_na_with_mean)
graph <- dygraph(havaK_filled_mean, main = "Hava Kalitesi (Mean)") %>%
 dyOptions(colors = c("blue", "red", "green", "orange", "purple", "brown")) %>%
 dyRangeSelector()
graph

# NA değerleri interpolation ile doldurup grafik çıkartma
library(zoo) #interpolation işlemi için

havaK_filled_inter <- havaK
havaK_filled_inter[,-1] <- na.approx(havaK[,-1])
graph <- dygraph(havaK_filled_inter, main = "Hava Kalitesi (Interpolation)") %>%
 dyOptions(colors = c("blue", "red", "green", "orange", "purple", "brown")) %>%
 dyRangeSelector()
graph

```
